(function(){var a=devhd.pkg("pages");var e=devhd.i18n.L;var c=devhd.log.get("page.mix");a.MixPage=function(g){this.guid=g};var d=a.MixPage.prototype=new a.BasePage();d.service=function(h,g){this.pageInfo=h;this.width=g.width;this.initBase(g);var i=this.pageInfo.key.split("/");this.publisherId=i[0];this.title=i[1];this.startRenderHTML()};d.destroy=function(h,g){this.destroyBase()
};d.allowsSideArea=function(){return false};d.allowsPageHeader=function(){return false};d.startRenderHTML=function(){try{this.feedly.setNbrPages(1);this.feedly.selectTab("#mix");this.feedly.pushContext({uri:this.pageInfo.uri,pageNumber:0,title:this.title,level:0});this.feedly.setPageTitle(this.title);this.pageElem.innerHTML=templates.page.mix.layout(this.width,this.home);
this.videos=[];var g=this;devhd.utils.FlowUtils.parallel(g,[function(i){g.reader.askMix(g.pageInfo.key,function(j){try{b.call(g,j);devhd.fn.callback(i)}catch(k){$debug("[mix]"+k.name+" -- "+k.message);devhd.fn.callback(i)}})},function(i){g.netcaster.askMixInfo(g.pageInfo.key,function(j){if(j!=null){g.feedly.setPageTitle(templates.page.mix.title(j));
g.title=j.title+" | by "+j.profile.name;f.call(g,j)}devhd.fn.callback(i)})}],{onComplete:function(){}})}catch(h){this.pageElem.innerHTML=devhd.utils.ExceptionUtils.formatError("layout mix",h)}};function f(h){if(this.home.isEmbedded()==false){return}if(h==null||h.skin==null||h.skin.links==null){return}var j=this.home.getDocument();var i=devhd.utils.CSSUtils.lookupStyle(j,".read");
if(i!=null){i.style.color=h.skin.links}var g=devhd.utils.CSSUtils.lookupStyle(j,".unread");if(g!=null){g.style.color=h.skin.links}}function b(r){if(r==null||r.length==0){this.pageElem.innerHTML=templates.page.mix.empty();return}var q=r;var o=q.slice(0,16);var n=3;var m=[],l=[];for(var h=0;h<n&&(2*h+1<o.length);h++){m.push(o[2*h]);l.push(o[2*h+1])}var k=o.slice(2*n);
if(m.length==0){this.pageElem.innerHTML=templates.page.base.empty(this.reader.listSubscriptions().length,this.reader.listRankedCategories({}),this.width,this.home);return}this.element("headlines1").innerHTML=templates.page.mix.displayRecommendations(m,this.home);for(var h=0;h<m.length;h++){this.askFindVisual(m[h],"U10")}this.element("headlines2").innerHTML=templates.page.mix.displayRecommendations(l,this.home);
for(var h=0;h<l.length;h++){this.askFindVisual(l[h],"U10")}var p=[];for(var g=1;g<k.length;g++){p.push({entry:k[g],type:4})}if(!devhd.utils.DateUtils.isWeekEnd()){p=p.sort(function(j,i){return i.entry.lastModifiedTime-j.entry.lastModifiedTime})}this.element("headlines3").innerHTML=templates.page.mix.layoutFeatured(p,this.width,{includeSourceTitle:true,includeCategoryLabel:false,includeNoThanks:false,includeFavIcon:true},this.home);
for(var g=0;g<p.length;g++){this.askFindVisual(p[g].entry,"U4")}}})();