(function(){var c=devhd.pkg("control");var b=devhd.control.BaseControl.prototype;var a=c.createClass("RecommendationAreaControl",c.BaseControl);a.initialize=function(){b.initialize.call(this);this.minVisible=0;this.showSourceTitle=true};a.destroy=function(d){this.page=null;this.reader=null;this.featured=null;this.minVisible=null;this.showSourceTitle=null;
b.destroy.call(this)};a.setReader=function(d){this.reader=d};a.setPage=function(d){this.page=d};a.setFeatured=function(d){this.featured=d};a.setMinVisible=function(d){this.minVisible=d};a.showSourceTitle=function(d){this.showSourceTitle=d};a.setDisplayMode=function(d){this.displayMode=d};a.display=function(){if(this.featured.length==0){return}this.part.innerHTML=templates.page.base.displayRecommendationArea(this.featured.length,this.home);
this.element("recommentationAreaHeadlines").innerHTML=templates.page.base.displayRecommendations(this.featured.slice(0,3),this.home);for(var e=0;e<this.featured.length;e++){this._askRecommendationVisual(this.featured[e])}if(this.featured.length>3){var f=[];for(var d=3;d<this.featured.length;d++){f.push({entry:this.featured[d],type:4})}this.element("recommentationAreaOthers").innerHTML=templates.page.base.parts(f,this.page.width,{includeSourceTitle:true,includeCategoryLabel:false,includeNoThanks:true,includeFavIcon:true},this.home);
for(var d=3;d<this.featured.length;d++){this.page.askFindVisual(this.featured[d],"U4")}}else{this.element("recommentationAreaOthers").style.display="none"}};a._askRecommendationVisual=function(e,j){var d=devhd.utils.PageConstants.UR_IMAGE_WIDTH;var f=devhd.utils.PageConstants.UR_IMAGE_HEIGHT;var i=this.page._createAndEnlistVisualFinder(e,d,f,85,55);
var g=this;i.onVisualReady=function(k,h){g.askDisplayURVisual(k,h,d,f)};i.onNoVisual=function(h){var k=e.getEnclosure("audio");if(k!=null){var l=g.element(e.getId()+"_main_visual");if(l!=null){l.style.background="url("+devhd.s3("images/podcast.png")+")";l.style.cursor="pointer";g.bind(l,"click",function(){g.part.innerHTML=templates.page.base.mediaPlayer(k.href,devhd.utils.PageConstants.U4_IMAGE_WIDTH,devhd.utils.PageConstants.U4_IMAGE_HEIGHT,true,true);
return false})}}else{g.askHandleNoURVisual(h)}};i.start()};a.askDisplayURVisual=function(g,e,d,f){if(this.page.state=="destroyed"){return}this.page._delistVisualFinder(g);this._displayRecommendationVisual(g,e,d,f)};a.askHandleNoURVisual=function(e,d){if(this.isDestroyed()==true){return}this.page._delistVisualFinder(e);var f=this.element(e+"_main_visual");
if(f!=null){f.innerHTML=templates.page.base.noRecommendationMediaFoundVisual(this.home)}};a._displayRecommendationVisual=function(f,e,d,g){var i=this.element(f+"_main_visual");if(i==null){return}i.innerHTML=templates.page.base.visual(f,e,d,g);i.style.display="block"};a._askU4Visual=function(d,g){var f=this.page._createAndEnlistVisualFinder(d,devhd.utils.PageConstants.U4_IMAGE_WIDTH,devhd.utils.PageConstants.U4_IMAGE_HEIGHT,85,55);
var e=this;f.onVisualReady=function(i,h){e.askDisplayU4Visual(i,h)};f.onNoVisual=function(h){e.askHandleNoU4Visual(h)};f.start()};a.askDisplayU4Visual=function(e,d){if(this.isDestroyed()==true){return}this.page._delistVisualFinder(e);var f=this.element(anEntryId+"_main_visual");if(f==null){return}f.innerHTML=templates.page.base.visual(anEntryId,d,devhd.utils.PageConstants.U4_IMAGE_WIDTH,devhd.utils.PageConstants.U4_IMAGE_HEIGHT);
f.style.display="block"};a.askHandleNoU4Visual=function(e,d){if(this.isDestroyed()==true){return}this.page._delistVisualFinder(e)};a.markAllAsRead=function(){if(this.featured!=null){for(var d=0;d<this.featured.length;d++){this.reader.markEntryAsRead(this.featured[d].getId())}}};a.findNextEntyId=function(e,h){if(this.featured==null){return null}var g=false;
if(e==null){g=true}for(var d=0;d<this.featured.length;d++){var f=this.featured[d];if(g==true){if(!h||(h&&f.isRead()==false)){return f.getId()}}else{if(e==f.getId()){g=true}}}return g===true?true:null};a.findPreviousEntyId=function(e,h){if(this.featured==null){return null}var g=false;if(e==null){g=true}for(var d=this.featured.length-1;d>=0;d--){var f=this.featured[d];
if(g==true){if(!h||(h&&f.isRead()==false)){return f.getId()}}else{if(e==f.getId()){g=true}}}return g===true?true:null}})();